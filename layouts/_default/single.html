{{ define "main"}}
  <h1>{{ .Title }}</h1>
  {{ partial "header.html" . }}
  {{ if not .Date.IsZero }}
  <!-- date -->
  {{ $singlePageDateFormat := .Site.Params.singlePageDateFormat | default "January 2, 2006"}}
  <p class="date">{{ .Date.Format $singlePageDateFormat }}</p>
  {{ end }}
  <!-- tags -->
  {{ if .Param "tags" }}
  <div id="tags">
    <ul>
      {{ range .Param "tags" }}
        {{ $name := . }}
        {{ with $.Site.GetPage (printf "/tags/%s" ($name | urlize)) }}
          <li><a href="{{ .Permalink }}">{{ $name }}</a></li>
        {{ end }}
      {{ end }}
    </ul>
  </div>
  <span id="{{ .RelPermalink }}" class="leancloud_visitors" data-flag-title="{{ .Title }}">
    <i class="post-meta-item-text">本文阅读量：</i>
    <i class="leancloud-visitors-count"></i>
</span>
  {{ end }}
  <!-- content -->
  <div id="contentBody">
    {{ .Content }}
  </div>
  <!-- Valine CMS -->
  <div style="max-width: 800px; margin: 0 auto; padding: 20px 0; text-align: center;">
    <center>끝</center>
    <hr>
    <center>评论区</center>
    <div id="vcomments"></div>
  <script>
    new Valine({
      el: '#vcomments',
      appId: 'zUGJX5XjhYuxYHvB09Vp7a3O-gzGzoHsz',
      appKey: 'rJW0i9oYJIWJFNpGG8nFydS7',
      placeholder: '阿巴阿巴阿巴(ˉ﹃ˉ)',
      avatar: 'retro',
      pageSize: 9,
      visitor: true,
      highlight: true,
      avatarForce: false,
      recordIP: true,
      requiredFields: ['nick','mail'],
      // Bilibili emojiCDN
      emojiCDN: '//i0.hdslb.com/bfs/emote/',
      // Emoji maps
      emojiMaps: {
        "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
        "tv_亲亲": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
        "tv_偷笑": "bb690d4107620f1c15cff29509db529a73aee261.png",
        "tv_再见": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
        "tv_冷漠": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
        "tv_发怒": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
        "tv_发财": "34db290afd2963723c6eb3c4560667db7253a21a.png",
        "tv_可爱": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
        "tv_吐血": "09dd16a7aa59b77baa1155d47484409624470c77.png",
        "tv_呆": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
        "tv_呕吐": "9f996894a39e282ccf5e66856af49483f81870f3.png",
        "tv_困": "241ee304e44c0af029adceb294399391e4737ef2.png",
        "tv_坏笑": "1f0b87f731a671079842116e0991c91c2c88645a.png",
        "tv_大佬": "093c1e2c490161aca397afc45573c877cdead616.png",
        "tv_大哭": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
        "tv_委屈": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
        "tv_害羞": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
        "tv_尴尬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
        "tv_微笑": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
        "tv_思考": "90cf159733e558137ed20aa04d09964436f618a1.png",
        "tv_惊吓": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png",
        "tv_打脸": "56ab10b624063e966bfcb76ea5dc4794d87dfd47.png",
        "tv_抓狂": "fe31c08edad661d63762b04e17b8d5ae3c71a757.png",
        "tv_抠鼻": "c666f55e88d471e51bbd9fab9bb308110824a6eb.png",
        "tv_斜眼笑": "911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png",
        "tv_无奈": "ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png",
        "tv_晕": "5443c22b4d07fb1907ccc610c8e6db254f2461b7.png",
        "tv_流汗": "cead1c351ab8d79e9f369605beb90148db0fbed3.png",
        "tv_流泪": "7e71cde7858f0cd50d74b0264aa26db612a8a167.png",
        "tv_流鼻血": "c32d39db2737f89b904ca32700d140a9241b0767.png",
        "tv_点赞": "f85c354995bd99e28fc76c869bfe42ba6438eff4.png",
        "tv_生气": "26702dcafdab5e8225b43ffd23c94ac1ff932654.png",
        "tv_生病": "8b0ec90e6b86771092a498c54f09fc94621c1900.png",
        "tv_疑问": "0793d949b18d7be716078349c202c15ff166f314.png",
        "tv_白眼": "c1d59f439e379ee50eef488bcb5e5378e5044ea4.png",
        "tv_皱眉": "72ccad6679fea0d14cce648b4d818e09b8ffea2d.png",
        "tv_目瞪口呆": "0b8cb81a68de5d5365212c99375e7ace3e7891b7.png",
        "tv_睡着": "8b196675b53af58264f383c50ad0945048290b33.png",
        "tv_笑哭": "1abc628f6d4f4caf9d0e7800878f4697abbc8273.png",
        "tv_腼腆": "89712c0d4af73e67f89e35cbc518420380a7f6f4.png",
        "tv_色": "61822c7e9aae5da76475e7892534545336b23a6f.png",
        "tv_调侃": "4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png",
        "tv_调皮": "b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png",
        "tv_鄙视": "6e72339f346a692a495b123174b49e4e8e781303.png",
        "tv_闭嘴": "c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png",
        "tv_难过": "87f46748d3f142ebc6586ff58860d0e2fc8263ba.png",
        "tv_馋": "fc7e829b845c43c623c8b490ee3602b7f0e76a31.png",
        "tv_鬼脸": "0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png",
        "tv_黑人问号": "45821a01f51bc867da9edbaa2e070410819a95b2.png",
        "tv_鼓掌": "1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png"
      }
    })
  </script>
  </div>
  <!-- Back to top -->
  <div title="返回顶部" id="backToTop" class="toTop">
    <i onclick="gotoTop();return false;" class="iconfont icon-fanhuidingbu1"></i>
  </div>
  <style type="text/css">
    div.toTop {
      position: fixed;
      right: 18px;
      bottom: 100px;
      margin: 0;
      padding: 0;
      display: none;
    }
    div.toTop i {
      font-size: 250%;
    }
    div.toTop i:hover {
      cursor: pointer;
      color: #33ba91;
    }
  </style>
  <script>
    // 隐藏与显示返回顶部按钮
    window.onscroll = function() {
      if (document.documentElement.scrollTop + document.body.scrollTop > 100) {
        document.getElementById("backToTop").style.display = "block";
      } else {
        document.getElementById("backToTop").style.display = "none";
      }
    }

    // 平滑返回顶部脚本
    function gotoTop(acceleration,stime) {
      acceleration = acceleration || 0.1;
      stime = stime || 10;

      var x1 = 0;
      var y1 = 0;
      var x2 = 0;
      var y2 = 0;
      var x3 = 0;
      var y3 = 0;

      if (document.documentElement) {
          x1 = document.documentElement.scrollLeft || 0;
          y1 = document.documentElement.scrollTop || 0;
      }
      if (document.body) {
          x2 = document.body.scrollLeft || 0;
          y2 = document.body.scrollTop || 0;
      }
      var x3 = window.scrollX || 0;
      var y3 = window.scrollY || 0;

      // 滚动条到页面顶部的水平距离
      var x = Math.max(x1, Math.max(x2, x3));
      // 滚动条到页面顶部的垂直距离
      var y = Math.max(y1, Math.max(y2, y3));

      // 滚动距离 = 目前距离 / 速度, 因为距离原来越小, 速度是大于 1 的数, 所以滚动距离会越来越小
      var speeding = 1 + acceleration;
      window.scrollTo(Math.floor(x / speeding), Math.floor(y / speeding));

      // 如果距离不为零, 继续调用函数
      if(x > 0 || y > 0) {
          var run = "gotoTop(" + acceleration + ", " + stime + ")";
          window.setTimeout(run, stime);
      }
    }
  </script>
  {{ partial "footer.html" . }}
{{ end }}
